#include "main.h"


int main()
{
	//Test Vectors
	uint8_t PT[16] = { 0x10, 0x11, 0x12, 0x13, 0x14, 0x15, 0x16, 0x17, 0x18, 0x19, 0x1a, 0x1b, 0x1c, 0x1d, 0x1e, 0x1f };
	uint8_t key[16] = { 0x0f, 0x1e, 0x2d, 0x3c, 0x4b, 0x5a, 0x69, 0x78, 0x87, 0x96, 0xa5, 0xb4, 0xc3, 0xd2, 0xe1, 0xf0 };
	uint8_t CT[16] = { 0X00, };
	uint8_t De_PT[16] = { 0X00, };

	//Key Schedule Part
	uint32_t rk[24][6] = { 0x00, };
	LEA_Keyschedule(key, rk);

	//ECB_암호화
	printf("<ECB_Encryption_part>");
	LEA_Round_Encrypt(PT, rk, CT);
	printf("\n");
	ECB_Encrypt_printstate(CT, 16);

	printf("\n");

	//ECB_복호화
	printf("<ECB_Decryption_part>");
	printf("\n");
	LEA_Round_Decrypt(CT, rk, De_PT);
	ECB_Decrypt_printstate(De_PT, 16);

	printf("\n");

	//CTR_암호화
	uint8_t CTR_PT[48] = { 0xDE,0x12,0x1D,0xFC,0x8F,0xB1,0x69,0xDB,0xE3,0x20,0x19,0x10,0xB2,0xA7,0xE7,0xBE,0xA5,0x1D,0xDE,0x10,0x48,0xAB,0x12,0x1F,0x60,0xD2,0x8D,0x16,0x7E,0xAF,0x8C,0x94,0xD4,0x7E,0xEC,0x51,0x48,0x5E,0xDF,0x05,0xC7,0x53,0xE3,0x85,0xDC,0x91,0xF5,0x2F };
	uint8_t CTR_COUNTER[16] = { 0xAB,0xDD,0x29,0x8C,0xBA,0x9F,0x58,0xE0,0x5D,0x1C,0xEA,0x4C,0xF4,0x07,0x58,0xB5 };
	uint8_t CTR_KEY[16] = { 0x76,0x3D,0xC8,0x78,0xA1,0xE4,0x93,0x14,0x17,0xE6,0xA4,0xDF,0xFE,0x9F,0x72,0xC1 };
	uint8_t CTR_CT[48] = { 0x00, };
	uint8_t CTR_DE_PT[48] = { 0x80,0x80, };

	printf("<CTR_Encryption_part>");
	LEA_CTR(CTR_PT, CTR_COUNTER, 48, CTR_KEY, CTR_CT);
	printf("\n");
	CTR_Encrypt_printstate(CTR_CT, 48);

	printf("\n");

	//CTR_복호화
	printf("<CTR_Decryption_part>");
	printf("\n");
	LEA_CTR(CTR_CT, CTR_COUNTER, 48, CTR_KEY, CTR_DE_PT);
	CTR_Decrypt_printstate(CTR_DE_PT, 48);
	
	printf("\n");

	//CBC암호화
	uint8_t CBC_PT[48] = { 0xDE,0x12,0x1D,0xFC,0x8F,0xB1,0x69,0xDB,0xE3,0x20,0x19,0x10,0xB2,0xA7,0xE7,0xBE,0xA5,0x1D,0xDE,0x10,0x48,0xAB,0x12,0x1F,0x60,0xD2,0x8D,0x16,0x7E,0xAF,0x8C,0x94,0xD4,0x7E,0xEC,0x51,0x48,0x5E,0xDF,0x05,0xC7,0x53,0xE3,0x85,0xDC,0x91,0xF5,0x2F };
	uint8_t CBC_IV[16] = { 0xAB,0xDD,0x29,0x8C,0xBA,0x9F,0x58,0xE0,0x5D,0x1C,0xEA,0x4C,0xF4,0x07,0x58,0xB5 };
	uint8_t CBC_KEY[16] = { 0x76,0x3D,0xC8,0x78,0xA1,0xE4,0x93,0x14,0x17,0xE6,0xA4,0xDF,0xFE,0x9F,0x72,0xC1 };
	uint8_t CBC_CT[48] = { 0x00, };
	uint8_t CBC_DE_PT[48] = { 0x00, };

	printf("<CBC_Encryption_Part>");
	CBCmode_Encrypt_LEA(CBC_PT, CBC_IV, 48, CBC_KEY, CBC_CT);
	printf("\n");
	CBC_Encrypt_printstate(CBC_CT, 48);

	printf("\n");


	//CBC복호화
	printf("<CBC_Decryption_Part>");
	CBCmode_Decrypt_LEA(CBC_CT, CBC_IV, 48, CBC_KEY, CBC_DE_PT);
	CBC_Decrypt_printstate(CBC_DE_PT, 48);


	return 0;
}

